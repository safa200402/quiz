<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="description" content="Quiz dengan pilihan ganda dan jawaban singkat">
	<title>Quiz Interaktif</title>
	<style>
		body {
			margin: 0px;
			overflow: hidden;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
			transition: background 1s ease;
		}
		.quiz-container {
			background: rgba(255, 255, 255, 0.95);
			padding: 20px 30px;
			border-radius: 15px;
			box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
			max-width: 400px;
			color: #000;
			text-align: center;
			position: relative;
			overflow: auto;
			max-height: 81%;
			height: max-content;
			width: 81%;
			padding: 15px;
			bottom: 7%;
		}
		.question {
			font-family: Amiri;
			font-size: 1.2rem;
			margin: 20px 15px 15px 15px;
		}
		.options, .short-answer {
			margin-bottom: 15px;
		}
		.options button, .short-answer button, #nextBtn, #startBtn, #feedbackBtn {
			font-family: Amiri;
			margin-top: 10px;
			display: block;
			width: 100%;
			background: #1E90FF;
			color: #fff;
			border: none;
			padding: 10px;
			border-radius: 5px;
			cursor: pointer;
			transition: background 0.3s;
		}
		.options button:hover,
		#feedbackBtn:hover {
			background: #1C86EE;
		}
		.options button:disabled {
			background: #ccc;
			cursor: not-allowed;
		}
		.short-answer input {
			margin-top: 10px;
			border: solid 1px black;
			padding: 5px 7px;
			border-radius: 5px;
			width: 100%;
		}
		#result {
			margin-top: 15px;
			font-weight: bold;
		}
		.progress {
			position: absolute;
			top: 10px;
			right: 15px;
			font-size: 0.7rem;
		}
		@media (max-width: 480px) {
			.quiz-container {
				width: 81%;
				padding: 15px;
			}
		}
	</style>
</head>
<body id="body" style="font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: linear-gradient(135deg, #87CEEB, #ffffff); color: #333; position: fixed; top: 0px; right: 0px; width: -webkit-fill-available;">
	<div class="quiz-container">
		<div id="description">
			<h1>Quiz Interaktif</h1>
			Jawablah setiap pertanyaan dengan benar.
		</div>
		<button id="startBtn" onclick="startQuiz()">Mulai Quiz</button>
		<div id="quizContent" style="display: none;">
			<div class="progress" id="progress">Soal: 0 / 0</div>
			<div class="question" id="question" dir="auto"></div>
			<div class="options" id="options"></div>
			<div class="short-answer" id="shortAnswerContainer" style="display: none;">
				<input type="text" id="shortAnswer" placeholder="Jawaban kamu...">
				<button onclick="submitShortAnswer()">Submit</button>
			</div>
			<button id="feedbackBtn" onclick="kritikSoal()">Kritik Soal</button>
			<div id="result"></div>
			<button id="nextBtn" onclick="nextQuestion()">Lanjutkan</button>
		</div>
	</div>

	<script>
		let questions = [
			{ question: "Apa ibukota Indonesia?", options: ["Jakarta", "Bandung", "Surabaya"], answer: "Jakarta" },
			{ question: "Sebutkan warna bendera Indonesia:", options: [], answer: "merah putih" },
			{ question: "2 + 2 = ?", options: ["3", "4", "5"], answer: "4" },
			{ question: "Siapa presiden pertama Indonesia?", options: ["Sukarno", "Suharto", "Jokowi"], answer: "Sukarno" }
		];

		let currentQuestion = 0, score = 0, startTime = 0;
		const body = document.getElementById('body');

		function startQuiz() {
			document.getElementById("startBtn").style.display = "none";
			document.getElementById("description").style.display = "none";
			document.getElementById("quizContent").style.display = "block";
			startTime = Date.now();
			updateProgress();
			loadQuestion();
		}

		function loadQuestion() {
			const q = questions[currentQuestion];
			document.getElementById("question").innerText = q.question;
			const optionsContainer = document.getElementById("options");
			optionsContainer.innerHTML = "";
			document.getElementById("shortAnswerContainer").style.display = q.options.length > 0 ? "none" : "block";
			document.getElementById("shortAnswer").value = "";
			document.getElementById("nextBtn").style.display = "none";
			document.getElementById("result").innerText = "";

			if (q.options.length > 0) {
				q.options.forEach(option => {
					optionsContainer.innerHTML += `<button onclick="checkAnswer(this, '${sanitizeOption(option)}')" dir="auto">${sanitizeOption(option)}</button>`;
				});
			}

			updateProgress();
			updateBackground();
		}

		function updateProgress() {
			document.getElementById("progress").innerText = `Soal: ${currentQuestion + 1} / ${questions.length}`;
		}

		function updateBackground() {
			const progress = (currentQuestion + 1) / questions.length;
			if (progress >= 0.75) {
				document.getElementById("container").style.background = 'linear-gradient(135deg, #8A2BE2, #FFFFFF)'; // ungu
			} else if (progress >= 0.5) {
				document.getElementById("container").style.background = 'linear-gradient(135deg, #3CB371, #FFFFFF)'; // hijau
			} else if (progress >= 0.25) {
				document.getElementById("container").style.background = 'linear-gradient(135deg, #1E90FF, #FFFFFF)'; // biru
			} else {
				document.getElementById("container").style.background = 'linear-gradient(135deg, #87CEEB, #FFFFFF)'; // biru langit
			}
		}

		function checkAnswer(element, answer) {
			const result = document.getElementById("result");
			const correct = questions[currentQuestion].answer.toLowerCase();
			if (answer.toLowerCase() === correct) score++;
			result.innerText = answer.toLowerCase() === correct ? "Benar!" : `Salah! Jawaban: ${questions[currentQuestion].answer}`;
			speakText(result.innerText, 'id-ID');
			document.querySelectorAll('.options button').forEach(btn => btn.disabled = true);
			document.getElementById("nextBtn").style.display = "block";
		}

		function submitShortAnswer() {
			const answer = document.getElementById("shortAnswer").value.trim();
			checkAnswer(null, answer);
		}

		function kritikSoal() {
			const kritik = prompt("Masukkan kritik atau saran untuk soal ini:");
			if (kritik) {
				console.log(`Kritik untuk soal "${questions[currentQuestion].question}": ${kritik}`);
				alert("Terima kasih atas masukan Anda!");
			}
		}

		function nextQuestion() {
			currentQuestion++;
			if (currentQuestion >= questions.length) return endQuiz();
			loadQuestion();
		}

		function endQuiz() {
			const duration = ((Date.now() - startTime) / 1000).toFixed(2);
			const scorePercentage = ((score / questions.length) * 100).toFixed(2);
			document.querySelector('.quiz-container').innerHTML = `
				<h2>Quiz Selesai!</h2>
				<p>Nilai Kamu: ${scorePercentage}/100</p>
				<p>Waktu: ${duration} detik</p>
				<p>This quiz was created by Abu Ardlin Salman.</p>
			`;
		}

		function speakText(text, language) {
			if ('speechSynthesis' in window) {
				let utterance = new SpeechSynthesisUtterance(text);
				utterance.lang = language;
				speechSynthesis.speak(utterance);
			}
		}

		function sanitizeOption(input) {
			return input.replace(/[<>"'&]/g, function (match) {
				switch (match) {
					case '<': return '&lt;';
					case '>': return '&gt;';
					case '"': return '&quot;';
					case "'": return '&#39;';
					case '&': return '&amp;';
				}
			}).trim();
		}
	</script>
</body>
</html>
